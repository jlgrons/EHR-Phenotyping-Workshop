plot_roc(list(roc_lasso, roc_alasso), legend("LASSO", "ALASSO"))
plot_roc <- function(rocs, legend = c("LASSO", "ALASSO")) {
cols <- c("LASSO"="#F8766D", "ALASSO"="#7CAE00", "PheCAP"="#00BFC4",
"Two-step"="#C77CFF", "MAP"="#CD9600", "SVM"="#00A9FF",
"Random forest"="#00BE67", "ICD"="#FF64B0", "NLP"="#619CFF")
label_text <- c()
for (i in c(1:length(rocs)) {
label_text <- c(label_text, paste(legend[i], ", AUC =", round(auc(rocs[i]), 3)))
}
ggroc(list(roc_lasso, roc_alasso), legacy.axes = TRUE) +
scale_colour_manual(values = cols, labels = label_text, limits = legend)) +
theme(legend.position = "bottom") +
ggtitle("The operating receiver characteristic (ROC) curve") +
guides(color = guide_legend(title = element_blank())) +
labs(x = "False positive rate (FPR)", y = "True positive rate (TPR)")
}
plot_roc(list(roc_lasso, roc_alasso), legend("LASSO", "ALASSO"))
plot_roc(list(roc_lasso, roc_alasso), legend("LASSO", "ALASSO"))
plot_roc <- function(rocs, legend = c("LASSO", "ALASSO")) {
cols <- c("LASSO"="#F8766D", "ALASSO"="#7CAE00", "PheCAP"="#00BFC4",
"Two-step"="#C77CFF", "MAP"="#CD9600", "SVM"="#00A9FF",
"Random forest"="#00BE67", "ICD"="#FF64B0", "NLP"="#619CFF")
label_text <- c()
for (i in c(1:length(rocs)) {
label_text <- c(label_text, paste(legend[i], ", AUC =", round(auc(rocs[i]), 3)))
}
ggroc(list(roc_lasso, roc_alasso), legacy.axes = TRUE) +
scale_colour_manual(values = cols, labels = label_text, limits = legend)) +
theme(legend.position = "bottom") +
ggtitle("The operating receiver characteristic (ROC) curve") +
guides(color = guide_legend(title = element_blank())) +
labs(x = "False positive rate (FPR)", y = "True positive rate (TPR)")
}
plot_roc <- function(rocs, legend = c("LASSO", "ALASSO")) {
cols <- c("LASSO"="#F8766D", "ALASSO"="#7CAE00", "PheCAP"="#00BFC4",
"Two-step"="#C77CFF", "MAP"="#CD9600", "SVM"="#00A9FF",
"Random forest"="#00BE67", "ICD"="#FF64B0", "NLP"="#619CFF")
label_text <- c()
for (i in c(1:length(rocs)) {
label_text <- c(label_text, paste(legend[i], ", AUC =", round(auc(rocs[i]), 3)))
}
ggroc(list(roc_lasso, roc_alasso), legacy.axes = TRUE) +
scale_colour_manual(values = cols, labels = label_text, limits = legend)) +
theme(legend.position = "bottom") +
ggtitle("The operating receiver characteristic (ROC) curve") +
guides(color = guide_legend(title = element_blank())) +
labs(x = "False positive rate (FPR)", y = "True positive rate (TPR)")
}
plot_roc <- function(rocs, legend = c("LASSO", "ALASSO")) {
cols <- c("LASSO"="#F8766D", "ALASSO"="#7CAE00", "PheCAP"="#00BFC4",
"Two-step"="#C77CFF", "MAP"="#CD9600", "SVM"="#00A9FF",
"Random forest"="#00BE67", "ICD"="#FF64B0", "NLP"="#619CFF")
label_text <- c()
for (i in c(1:length(rocs)) {
label_text <- c(label_text, paste(legend[i], ", AUC =", round(auc(rocs[i]), 3)))
}
ggroc(list(roc_lasso, roc_alasso), legacy.axes = TRUE) +
scale_colour_manual(values = cols, labels = label_text, limits = legend)) +
theme(legend.position = "bottom") +
ggtitle("The operating receiver characteristic (ROC) curve") +
guides(color = guide_legend(title = element_blank())) +
labs(x = "False positive rate (FPR)", y = "True positive rate (TPR)")
}
plot_roc <- function(rocs, legend = c("LASSO", "ALASSO")) {
label_text <- c()
for (i in c(1:length(rocs))) {
label_text <- c(label_text, paste(legend[i], ", AUC =", round(auc(rocs[i]), 3)))
}
cols <- c("LASSO"="#F8766D", "ALASSO"="#7CAE00", "PheCAP"="#00BFC4",
"Two-step"="#C77CFF", "MAP"="#CD9600", "SVM"="#00A9FF",
"Random forest"="#00BE67", "ICD"="#FF64B0", "NLP"="#619CFF")
ggroc(list(roc_lasso, roc_alasso), legacy.axes = TRUE) +
scale_colour_manual(values = cols, labels = label_text, limits = legend) +
theme(legend.position = "bottom") +
ggtitle("The operating receiver characteristic (ROC) curve") +
guides(color = guide_legend(title = element_blank())) +
labs(x = "False positive rate (FPR)", y = "True positive rate (TPR)")
}
plot_roc(list(roc_lasso, roc_alasso), legend("LASSO", "ALASSO"))
rocs <- list(roc_lasso, roc_alasso)
legend = c("LASSO", "ALASSO")
label_text <- c()
for (i in c(1:length(rocs))) {
label_text <- c(label_text, paste(legend[i], ", AUC =", round(auc(rocs[i]), 3)))
}
label_text
1:length(rocs)
rocs[1]
auc(rocs[1])
auc(rocs[[1]])
label_text <- c()
for (i in c(1:length(rocs))) {
label_text <- c(label_text, paste(legend[i], ", AUC =", round(auc(rocs[[i]]), 3)))
}
label_text
label_text <- c()
for (i in c(1:length(rocs))) {
label_text <- c(label_text, paste0(legend[i], ", AUC =", round(auc(rocs[[i]]), 3)))
}
label_text
label_text <- c()
for (i in c(1:length(rocs))) {
label_text <- c(label_text, paste0(legend[i], ", AUC = ", round(auc(rocs[[i]]), 3)))
}
label_text
label_text <- c()
for (i in c(1:length(rocs))) {
label_text <- c(label_text, paste0(legend[i], ", AUC=", round(auc(rocs[[i]]), 3)))
}
label_text
cols <- c("LASSO"="#F8766D", "ALASSO"="#7CAE00", "PheCAP"="#00BFC4",
"Two-step"="#C77CFF", "MAP"="#CD9600", "SVM"="#00A9FF",
"Random forest"="#00BE67", "ICD"="#FF64B0", "NLP"="#619CFF")
ggroc(list(roc_lasso, roc_alasso), legacy.axes = TRUE) +
scale_colour_manual(values = cols, labels = label_text, limits = legend) +
theme(legend.position = "bottom") +
ggtitle("The operating receiver characteristic (ROC) curve") +
guides(color = guide_legend(title = element_blank())) +
labs(x = "False positive rate (FPR)", y = "True positive rate (TPR)")
ggroc(list(roc_lasso, roc_alasso), legacy.axes = TRUE) +
scale_colour_manual(values = cols, labels = label_text) +
theme(legend.position = "bottom") +
ggtitle("The operating receiver characteristic (ROC) curve") +
guides(color = guide_legend(title = element_blank())) +
labs(x = "False positive rate (FPR)", y = "True positive rate (TPR)")
ggroc(list(roc_lasso, roc_alasso), legacy.axes = TRUE) +
scale_colour_manual(values = cols, labels = label_text, limits = legend) +
theme(legend.position = "bottom") +
ggtitle("The operating receiver characteristic (ROC) curve") +
guides(color = guide_legend(title = element_blank())) +
labs(x = "False positive rate (FPR)", y = "True positive rate (TPR)")
ggroc(list(roc_lasso, roc_alasso), legacy.axes = TRUE)
p <- ggroc(list(roc_lasso, roc_alasso), legacy.axes = TRUE)
p$layers
p$scales
p$mapping
ggroc(list(roc_lasso, roc_alasso), aes = c("colour"), legacy.axes = TRUE) +
scale_colour_manual(values = cols, labels = label_text, limits = legend) +
theme(legend.position = "bottom") +
ggtitle("The operating receiver characteristic (ROC) curve") +
guides(color = guide_legend(title = element_blank())) +
labs(x = "False positive rate (FPR)", y = "True positive rate (TPR)")
ggroc(list(roc_lasso, roc_alasso), colour = legend, legacy.axes = TRUE) +
scale_colour_manual(values = cols, labels = label_text, limits = legend) +
theme(legend.position = "bottom") +
ggtitle("The operating receiver characteristic (ROC) curve") +
guides(color = guide_legend(title = element_blank())) +
labs(x = "False positive rate (FPR)", y = "True positive rate (TPR)")
ggroc(list(roc_lasso, roc_alasso), colour = list(roc_lasso, roc_alasso), legacy.axes = TRUE) +
scale_colour_manual(values = cols, labels = label_text, limits = legend) +
theme(legend.position = "bottom") +
ggtitle("The operating receiver characteristic (ROC) curve") +
guides(color = guide_legend(title = element_blank())) +
labs(x = "False positive rate (FPR)", y = "True positive rate (TPR)")
ggroc(list(roc_lasso, roc_alasso), colour = cols, legacy.axes = TRUE) +
scale_colour_manual(values = cols, labels = label_text, limits = legend) +
theme(legend.position = "bottom") +
ggtitle("The operating receiver characteristic (ROC) curve") +
guides(color = guide_legend(title = element_blank())) +
labs(x = "False positive rate (FPR)", y = "True positive rate (TPR)")
ggroc(list(roc_lasso, roc_alasso), aes(colour = cols), legacy.axes = TRUE) +
scale_colour_manual(values = cols, labels = label_text, limits = legend) +
theme(legend.position = "bottom") +
ggtitle("The operating receiver characteristic (ROC) curve") +
guides(color = guide_legend(title = element_blank())) +
labs(x = "False positive rate (FPR)", y = "True positive rate (TPR)")
ggroc(list(roc_lasso, roc_alasso), aes("colour" = cols), legacy.axes = TRUE) +
scale_colour_manual(values = cols, labels = label_text, limits = legend) +
theme(legend.position = "bottom") +
ggtitle("The operating receiver characteristic (ROC) curve") +
guides(color = guide_legend(title = element_blank())) +
labs(x = "False positive rate (FPR)", y = "True positive rate (TPR)")
ggroc(list(roc_lasso, roc_alasso), aes("colour"), legacy.axes = TRUE) +
scale_colour_manual(values = cols, labels = label_text, limits = legend) +
theme(legend.position = "bottom") +
ggtitle("The operating receiver characteristic (ROC) curve") +
guides(color = guide_legend(title = element_blank())) +
labs(x = "False positive rate (FPR)", y = "True positive rate (TPR)")
plot_roc <- function(rocs, legend = c("LASSO", "ALASSO")) {
label_text <- c()
for (i in c(1:length(rocs))) {
label_text <- c(label_text, paste0(legend[i], ", AUC=", round(auc(rocs[[i]]), 3)))
}
ggroc(list(roc_lasso, roc_alasso), aes("colour"), legacy.axes = TRUE) +
scale_colour_manual(labels = label_text) +
theme(legend.position = "bottom") +
ggtitle("The operating receiver characteristic (ROC) curve") +
guides(color = guide_legend(title = element_blank())) +
labs(x = "False positive rate (FPR)", y = "True positive rate (TPR)")
}
plot_roc(list(roc_lasso, roc_alasso), legend("LASSO", "ALASSO"))
plot_roc <- function(rocs, legend = c("LASSO", "ALASSO")) {
label_text <- c()
for (i in c(1:length(rocs))) {
label_text <- c(label_text, paste0(legend[i], ", AUC=", round(auc(rocs[[i]]), 3)))
}
ggroc(list(roc_lasso, roc_alasso), aes("colour"), legacy.axes = TRUE) +
scale_colour_manual(labels = label_text) +
theme(legend.position = "bottom") +
ggtitle("The operating receiver characteristic (ROC) curve") +
guides(color = guide_legend(title = element_blank())) +
labs(x = "False positive rate (FPR)", y = "True positive rate (TPR)")
}
plot_roc <- function(rocs, legend = c("LASSO", "ALASSO")) {
label_text <- c()
for (i in c(1:length(rocs))) {
label_text <- c(label_text, paste0(legend[i], ", AUC=", round(auc(rocs[[i]]), 3)))
}
ggroc(list(roc_lasso, roc_alasso), legacy.axes = TRUE) +
scale_colour_manual(labels = label_text) +
theme(legend.position = "bottom") +
ggtitle("The operating receiver characteristic (ROC) curve") +
guides(color = guide_legend(title = element_blank())) +
labs(x = "False positive rate (FPR)", y = "True positive rate (TPR)")
}
plot_roc(list(roc_lasso, roc_alasso), legend("LASSO", "ALASSO"))
plot_roc <- function(rocs, legend = c("LASSO", "ALASSO")) {
label_text <- c()
for (i in c(1:length(rocs))) {
label_text <- c(label_text, paste0(legend[i], ", AUC=", round(auc(rocs[[i]]), 3)))
}
ggroc(rocs, legacy.axes = TRUE) +
scale_colour_manual(labels = label_text) +
theme(legend.position = "bottom") +
ggtitle("The operating receiver characteristic (ROC) curve") +
guides(color = guide_legend(title = element_blank())) +
labs(x = "False positive rate (FPR)", y = "True positive rate (TPR)")
}
plot_roc(list(roc_lasso, roc_alasso), legend("LASSO", "ALASSO"))
plot_roc <- function(rocs, legend = c("LASSO", "ALASSO")) {
label_text <- c()
for (i in c(1:length(rocs))) {
label_text <- c(label_text, paste0(legend[i], ", AUC=", round(auc(rocs[[i]]), 3)))
}
ggroc(rocs, legacy.axes = TRUE) +
scale_colour_manual(labels = label_text) +
ggtitle("The operating receiver characteristic (ROC) curve") +
guides(color = guide_legend(title = element_blank())) +
labs(x = "False positive rate (FPR)", y = "True positive rate (TPR)")
}
plot_roc(list(roc_lasso, roc_alasso), legend("LASSO", "ALASSO"))
ggroc(list(roc_lasso, roc_alasso), legacy.axes = TRUE) +
scale_color_discrete(labels = c(
paste("LASSO, AUC =", round(auc(roc_lasso), 3)),
paste("ALASSO, AUC =", round(auc(roc_alasso), 3))
)) + theme(legend.position = "bottom") +
ggtitle("The operating receiver characteristic (ROC) curve") +
guides(color = guide_legend(title = element_blank())) +
labs(x = "False positive rate (FPR)", y = "True positive rate (TPR)")
ggroc(list(roc_lasso, roc_alasso), legacy.axes = TRUE) +
scale_color_discrete(labels = c(
paste("LASSO, AUC =", round(auc(roc_lasso), 3)),
paste("ALASSO, AUC =", round(auc(roc_alasso), 3))
)) + theme(legend.position = "bottom") +
ggtitle("The operating receiver characteristic (ROC) curve") +
guides(color = guide_legend(title = element_blank())) +
labs(x = "False positive rate (FPR)", y = "True positive rate (TPR)")
ggroc(list(roc_lasso, roc_alasso), legacy.axes = TRUE) +
scale_color_discrete(labels = c(
paste("LASSO, AUC =", round(auc(roc_lasso), 3)),
paste("ALASSO, AUC =", round(auc(roc_alasso), 3))
)) + theme(legend.position = "bottom") +
ggtitle("The operating receiver characteristic (ROC) curve") +
guides(color = guide_legend(title = element_blank())) +
labs(x = "False positive rate (FPR)", y = "True positive rate (TPR)") +
theme(axis.text = element_text(size = 10))
ggroc(list(roc_lasso, roc_alasso), legacy.axes = TRUE) +
scale_color_discrete(labels = c(
paste("LASSO, AUC =", round(auc(roc_lasso), 3)),
paste("ALASSO, AUC =", round(auc(roc_alasso), 3))
)) + theme(legend.position = "bottom") +
ggtitle("The operating receiver characteristic (ROC) curve") +
guides(color = guide_legend(title = element_blank())) +
labs(x = "False positive rate (FPR)", y = "True positive rate (TPR)") +
theme(axis.text = element_text(size = 12))
?theme
ggroc(list(roc_lasso, roc_alasso), legacy.axes = TRUE) +
scale_color_discrete(labels = c(
paste("LASSO, AUC =", round(auc(roc_lasso), 3)),
paste("ALASSO, AUC =", round(auc(roc_alasso), 3))
)) + theme(legend.position = "bottom") +
ggtitle("The operating receiver characteristic (ROC) curve") +
guides(color = guide_legend(title = element_blank())) +
labs(x = "False positive rate (FPR)", y = "True positive rate (TPR)") +
theme(axis.text = element_text(size = 12), legend.text = element_text(size = 12))
ggroc(list(roc_lasso, roc_alasso), legacy.axes = TRUE) +
scale_color_discrete(labels = c(
paste("LASSO, AUC =", round(auc(roc_lasso), 3)),
paste("ALASSO, AUC =", round(auc(roc_alasso), 3))
)) + theme(legend.position = "bottom") +
ggtitle("The operating receiver characteristic (ROC) curve") +
guides(color = guide_legend(title = element_blank())) +
labs(x = "False positive rate (FPR)", y = "True positive rate (TPR)") +
theme(text = element_text(size = 12))
ggroc(list(roc_lasso, roc_alasso), legacy.axes = TRUE) +
scale_color_discrete(labels = c(
paste("LASSO, AUC =", round(auc(roc_lasso), 3)),
paste("ALASSO, AUC =", round(auc(roc_alasso), 3))
)) + theme(legend.position = "bottom") +
ggtitle("The operating receiver characteristic (ROC) curve") +
guides(color = guide_legend(title = element_blank())) +
labs(x = "False positive rate (FPR)", y = "True positive rate (TPR)") +
theme(text = element_text(size = 15))
ggroc(list(roc_lasso, roc_alasso, roc_rf, roc_svm), legacy.axes = TRUE) +
scale_color_discrete(labels = c(
paste("LASSO, AUC =", round(auc(roc_lasso), 3)),
paste("Random Forest, AUC =", round(auc(roc_rf), 3)),
paste("ALASSO, AUC =", round(auc(roc_alasso), 3)),
paste("SVM, AUC =", round(auc(roc_svm), 3))
)) + theme(legend.position = "bottom") +
ggtitle("The operating receiver characteristic (ROC) curve") +
guides(color = guide_legend(ncol = 2, title = element_blank())) +
labs(x = "False positive rate (FPR)", y = "True positive rate (TPR)")+
theme(text = element_text(size = 15))
tidyr::gather(auc_supervised) %>%
mutate(
n = gsub(",.*$", "", key),
method = sub(".*,\\s*", "", key)
) %>%
ggplot(aes(y = value, color = method)) +
geom_boxplot(outlier.shape = NA) +
facet_wrap(. ~ n) +
ggtitle("Area under the ROC curve (AUC) from 600 simulations") +
theme(legend.position = "bottom", axis.text.x = element_blank(), axis.ticks = element_blank())+
theme(text = element_text(size = 15))
# Use ggplot
# Remove outlier for box plot
set.seed(99)
feature_index <- sample(c(3:ncol(ehr_data)), 10, replace = FALSE)
ehr_data[, feature_index] %>%
pivot_longer(everything(), names_to = "feature", values_to = "count") %>%
ggplot() +
geom_density(aes(x = count, color = feature))+
theme(text = element_text(size = 15))
set.seed(99)
feature_index <- sample(c(3:ncol(ehr_data)), 10, replace = FALSE)
ehr_data[, feature_index] %>%
pivot_longer(everything(), names_to = "feature", values_to = "count") %>%
ggplot() +
geom_density(aes(x = count, color = feature))+
theme(text = element_text(size = 25)) +
ggtitle("Density plots of randomly selected 10 features")
ggroc(list(roc_icd, roc_nlp), legacy.axes = TRUE) +
scale_color_discrete(labels = c(
paste("ICD, AUC =", round(auc(roc_icd), 3)),
paste("NLP, AUC =", round(auc(roc_nlp), 3))
)) + theme(legend.position = "bottom") +
ggtitle("The operating receiver characteristic (ROC) curve") +
guides(color = guide_legend(ncol = 2, title = element_blank())) +
theme(text = element_text(size = 20)) +
labs(x = "False positive rate (FPR)", y = "True positive rate (TPR)")
get_roc_parameter(0.1, roc_full_lasso)
get_roc_parameter(0.1, roc_full_alasso)
roc_full_phecap <- get_roc(y_true = test_y, y_score = y_hat_phecap) %>% data.frame()
get_roc_parameter(0.1, roc_full_phecap)
plot_roc(list(roc_lasso, roc_alasso), legend = c("LASSO", "ALASSO"))
plot_roc <- function(rocs,legend, n_total_method = 7) {
label_text <- c()
for (i in c(1:length(rocs))) {
label_text <- c(label_text, paste0(legend[i], ", AUC=", round(auc(rocs[[i]]), 3)))
}
ggroc(rocs, legacy.axes = TRUE) +
scale_colour_manual(values = scales::hue_pal()(n_total_method)[1:length(legend)],
labels = label_text) +
theme(legend.position = "bottom", text = element_text(size = 20)) +
ggtitle("The operating receiver characteristic (ROC) curve") +
guides(color = guide_legend(title = element_blank())) +
labs(x = "False positive rate (FPR)", y = "True positive rate (TPR)")
}
plot_roc(list(roc_lasso, roc_alasso), legend = c("LASSO", "ALASSO"))
plot_roc(list(roc_lasso, roc_alasso, roc_phecap), legend = c("LASSO", "ALASSO", "PheCAP"))
plot_roc(list(roc_lasso, roc_alasso, roc_rf, roc_svm), legend = c("LASSO", "ALASSO", "Random forest", "SVM"))
plot_roc(list(roc_lasso, roc_alasso, roc_rf, roc_svm), legend = c("LASSO", "ALASSO", "Random forest", "SVM"))
plot_roc(list(roc_icd, roc_nlp), legend = c("ICD", "NLP"))
plot_roc(list(roc_icd, roc_nlp), legend = c("ICD", "NLP"))
icd <- ehr_data %>%
filter(!is.na(label)) %>%
mutate(disease = factor(label)) %>%
ggplot(aes(x = log(main_ICD + 1))) +
geom_density(aes(color = disease)) +
theme(text = element_text(size = 20)) +
ggtitle("Density plots of the main ICD codes")
nlp <- ehr_data %>%
filter(!is.na(label)) %>%
mutate(disease = factor(label)) %>%
ggplot(aes(x = log(main_NLP + 1))) +
geom_density(aes(color = disease)) +
theme(text = element_text(size = 20)) +
ggtitle("Density plots of the main NLP codes")
figure <- ggarrange(icd, nlp, ncol = 2, nrow = 1)
figure
plot_sims <- function(data, n_total_method = 7) {
tidyr::gather(data) %>%
mutate(
n = gsub(",.*$", "", key),
method = sub(".*,\\s*", "", key)
) %>%
ggplot(aes(y = value, color = method)) +
scale_colour_manual(values = scales::hue_pal()(n_total_method)[1:length(legend)],
labels = label_text) +
geom_boxplot(outlier.shape = NA) +
facet_wrap(. ~ n) +
ggtitle("Area under the ROC curve (AUC) from 600 simulations") +
theme(text = element_text(size = 20)) +
theme(legend.position = "bottom", axis.text.x = element_blank(), axis.ticks = element_blank())
}
plot_sims(cbind(auc_supervised, auc_phecap))
plot_sims <- function(data, n_total_method = 4) {
tidyr::gather(data) %>%
mutate(
n = gsub(",.*$", "", key),
method = sub(".*,\\s*", "", key)
) %>%
ggplot(aes(y = value, color = method)) +
scale_colour_manual(values = scales::hue_pal()(n_total_method)[1:length(unique(data$method))],
labels = label_text) +
geom_boxplot(outlier.shape = NA) +
facet_wrap(. ~ n) +
ggtitle("Area under the ROC curve (AUC) from 600 simulations") +
theme(text = element_text(size = 20)) +
theme(legend.position = "bottom", axis.text.x = element_blank(), axis.ticks = element_blank())
}
plot_sims <- function(data, n_total_method = 4) {
tidyr::gather(data) %>%
mutate(
n = gsub(",.*$", "", key),
method = sub(".*,\\s*", "", key)
) %>%
ggplot(aes(y = value, color = method)) +
scale_colour_manual(values = scales::hue_pal()(n_total_method)[1:length(unique(data$method))]) +
geom_boxplot(outlier.shape = NA) +
facet_wrap(. ~ n) +
ggtitle("Area under the ROC curve (AUC) from 600 simulations") +
theme(text = element_text(size = 20)) +
theme(legend.position = "bottom", axis.text.x = element_blank(), axis.ticks = element_blank())
}
plot_sims(cbind(auc_supervised, auc_phecap))
datadsfds <- cbind(auc_supervised, auc_phecap)
datadsfds$method
plot_sims <- function(data, n_total_method = 4) {
plot_data <- tidyr::gather(data) %>%
mutate(
n = gsub(",.*$", "", key),
method = sub(".*,\\s*", "", key)
)
plot_data %>%
ggplot(aes(y = value, color = method)) +
scale_colour_manual(values = scales::hue_pal()(n_total_method)[1:length(unique(plot_data$method))]) +
geom_boxplot(outlier.shape = NA) +
facet_wrap(. ~ n) +
ggtitle("Area under the ROC curve (AUC) from 600 simulations") +
theme(text = element_text(size = 20)) +
theme(legend.position = "bottom", axis.text.x = element_blank(), axis.ticks = element_blank())
}
plot_sims(cbind(auc_supervised, auc_phecap))
plot_sims(cbind(auc_supervised, auc_phecap), legend = c("LASSO", "ALASSO", "PheCAP"))
plot_sims <- function(data, legend, n_total_method = 4) {
plot_data <- tidyr::gather(data) %>%
mutate(
n = gsub(",.*$", "", key),
method = sub(".*,\\s*", "", key)
)
plot_data %>%
ggplot(aes(y = value, color = method)) +
scale_colour_manual(values = scales::hue_pal()(n_total_method)[1:length(legend)]) +
geom_boxplot(outlier.shape = NA) +
facet_wrap(. ~ n) +
ggtitle("Area under the ROC curve (AUC) from 600 simulations") +
theme(text = element_text(size = 20)) +
theme(legend.position = "bottom", axis.text.x = element_blank(), axis.ticks = element_blank())
}
plot_sims(cbind(auc_supervised, auc_phecap), legend = c("LASSO", "ALASSO", "PheCAP"))
plot_sims <- function(data, legend, n_total_method = 7) {
plot_data <- tidyr::gather(data) %>%
mutate(
n = gsub(",.*$", "", key),
method = sub(".*,\\s*", "", key)
)
plot_data %>%
ggplot(aes(y = value, color = method)) +
scale_colour_manual(values = scales::hue_pal()(n_total_method)[1:length(legend)]) +
geom_boxplot(outlier.shape = NA) +
facet_wrap(. ~ n) +
ggtitle("Area under the ROC curve (AUC) from 600 simulations") +
theme(text = element_text(size = 20)) +
theme(legend.position = "bottom", axis.text.x = element_blank(), axis.ticks = element_blank())
}
plot_sims(cbind(auc_supervised, auc_phecap), legend = c("LASSO", "ALASSO", "PheCAP"))
data <- cbind(auc_supervised, auc_phecap)
plot_data <- tidyr::gather(data) %>%
mutate(
n = gsub(",.*$", "", key),
method = sub(".*,\\s*", "", key)
)
plot_data$method
plot_sims <- function(data, legend, n_total_method = 7) {
plot_data <- tidyr::gather(data) %>%
mutate(
n = gsub(",.*$", "", key),
method = sub(".*,\\s*", "", key)
)
plot_data$method <- factor(plot_data$method, levels = c("LASSO", "ALASSO", "PheCAP", "Two-step"))
plot_data %>%
ggplot(aes(y = value, color = method)) +
scale_colour_manual(values = scales::hue_pal()(n_total_method)[1:length(legend)]) +
geom_boxplot(outlier.shape = NA) +
facet_wrap(. ~ n) +
ggtitle("Area under the ROC curve (AUC) from 600 simulations") +
theme(text = element_text(size = 20)) +
theme(legend.position = "bottom", axis.text.x = element_blank(), axis.ticks = element_blank())
}
plot_sims(cbind(auc_supervised, auc_phecap), legend = c("LASSO", "ALASSO", "PheCAP"))
